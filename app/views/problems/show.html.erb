<%= render @problem %>

<h1><%= @problem.title %></h1>
<div class="problem-container">
  <aside class="votes">
    <div>
      <%# if user_signed_in? %>
        <% if @problem.liked?({ fake: "user", id: 2 }) %>
          <%= button_to "▲", problem_like_path(@problem), method: "put", class:"red" %>
        <% else %>
          <%= button_to "▲", problem_like_path(@problem), method: "put" %>
        <% end %>
      <%# end %>
    </div>
    <div><%= @problem.rating %></div>
    <div>
      <%# if user_signed_in? %>
        <% if @problem.disliked?({ fake: "user", id: 2 }) %>
          <%= button_to "▼", problem_dislike_path(@problem), method: "put", class:"red" %>
        <% else %>
          <%= button_to "▼", problem_dislike_path(@problem), method: "put" %>
        <% end %>
      <%# end %>
    </div>
  </aside>
  <article>
    <%= @problem.description %>
  </article>
</div>

<section class="comments-container">
  <details>
    <summary>Comment</summary>
    <p>
      <%= form_with scope: :comment, url: new_comment_path do |f| %>
        <%= f.text_area :content %><br>
        <%= f.hidden_field :parent_id, value: @problem.id %>
        <%= f.hidden_field :parent_type, value: @problem.class %>
        <%= f.submit %>
      <% end %>
    </p>
  </details>
  <% @problem.comments.all.each do |comment| %>
    <p>
      <%= comment.user.display_name %><br>
      <%= comment.content %><br>
      
      <%# if user_signed_in? %>
        <% if comment.liked?({ fake: "user", id: 2 }) %>
          <%= button_to "▲", comment_like_path(comment), method: "put", class:"red" %>
        <% else %>
          <%= button_to "▲", comment_like_path(comment), method: "put" %>
        <% end %>
      <%# end %>
    <%= comment.rating %>
      <%# if user_signed_in? %>
        <% if comment.disliked?({ fake: "user", id: 2 }) %>
          <%= button_to "▼", comment_dislike_path(comment), method: "put", class:"red" %>
        <% else %>
          <%= button_to "▼", comment_dislike_path(comment), method: "put" %>
        <% end %>
      <%# end %>

    </p>
  <% end %>
</section>